<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>운송 배정 상세 정보</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

    <script>
        // 기사 배정 함수
        function assignDriver() {
            const driverSelect = document.getElementById("driverSelect");
            const selectedDriver = driverSelect.value;
            const driverPhone = driverSelect.selectedOptions[0].dataset.phone;

            if (!selectedDriver) {
                alert("배송 기사를 선택해주세요.");
                return;
            }

            // 배정 정보 업데이트
            document.getElementById("assignedDriver").textContent = selectedDriver;
            document.getElementById("assignedPhone").textContent = driverPhone;
            document.getElementById("assignedTime").textContent = new Date().toLocaleString();

            // 기본 선택 옵션 제거
            driverSelect.options[0].remove();

            // '배정 완료' 버튼을 '기사 변경'으로 변경
            document.getElementById("assignButton").textContent = "기사 변경";

            // 배송 시작 버튼 활성화
            document.getElementById("startDeliveryButton").disabled = false;

            // 모달 닫기
            var assignModal = bootstrap.Modal.getInstance(document.getElementById("assignModal"));
            assignModal.hide();
        }

        // 배송 시작 함수
        function startDelivery() {
            const now = new Date().toLocaleString();
            document.getElementById("startDeliveryTime").textContent = now;
            document.getElementById("startDeliveryButton").disabled = true; // 버튼 비활성화
        }
    </script>

</head>
<body>

<main class="container my-4">
    <h2 class="text-center my-4">운송 배정 상세 정보</h2>

    <!-- ✅ 운송 상세 정보 -->
    <div class="table-responsive">
        <table class="table table-bordered table-striped">
            <thead class="table-dark">
            <tr class="text-center">
                <th colspan="2">운송 상세 정보</th>
            </tr>
            </thead>
            <tbody>
            <tr>
                <th>운송 번호</th>
                <td id="transpNo">1001</td>
            </tr>
            <tr>
                <th>출발지</th>
                <td>서울</td>
            </tr>
            <tr>
                <th>도착지</th>
                <td>부산</td>
            </tr>
            <tr>
                <th>운송 상태</th>
                <td><span class="badge bg-warning">배송 중</span></td>
            </tr>
            <tr>
                <th>요청 날짜</th>
                <td>2025-03-12</td>
            </tr>
            <tr>
                <th>출고 날짜</th>
                <td>2025-03-13</td>
            </tr>
            </tbody>
        </table>
    </div>

    <!-- ✅ 배정된 기사 정보 -->
    <div class="table-responsive my-4">
        <table class="table table-bordered table-striped">
            <thead class="table-dark">
            <tr class="text-center">
                <th colspan="2">운송 배정 정보</th>
            </tr>
            </thead>
            <tbody>
            <tr>
                <th>배정된 기사</th>
                <td id="assignedDriver">미배정</td>
            </tr>
            <tr>
                <th>전화번호</th>
                <td id="assignedPhone">-</td>
            </tr>
            <tr>
                <th>배차 시간</th>
                <td id="assignedTime">-</td>
            </tr>
            <tr>
                <th>배송 시작 시간</th>
                <td id="startDeliveryTime">미정</td>
            </tr>
            </tbody>
        </table>

    <!-- ✅ 버튼 영역 -->
    <div class="text-center">
        <button class="btn btn-success" data-bs-toggle="modal" data-bs-target="#assignModal" id="assignButton">배송 기사 배정</button>
        <button class="btn btn-primary" id="startDeliveryButton" onclick="startDelivery()" disabled>배송 시작</button>
        <a href="trsTransp.html" class="btn btn-success">목록</a>
    </div>
    </div>
</main>

<!-- ✅ 기사 배정 모달 -->
<div class="modal fade" id="assignModal" tabindex="-1">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">배송 기사 배정</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <label class="form-label">배송 기사 선택</label>
                <select id="driverSelect" class="form-select">
                    <option value="" disabled selected>전체</option>
                    <option value="김배달" data-phone="010-1234-5678">김배달 (010-1234-5678)</option>
                    <option value="감자" data-phone="010-9876-5432">감자 (010-9876-5432)</option>
                    <option value="운송송" data-phone="010-5555-6666">운송송 (010-5555-6666)</option>
                </select>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-success" onclick="assignDriver()">배정 완료</button>
            </div>
        </div>
    </div>
</div>

</body>
</html>
